[
  {
    "objectID": "sqldata.html",
    "href": "sqldata.html",
    "title": "SQL Analysis",
    "section": "",
    "text": "My goal for this analysis is to explore large amounts of wideband acoustic immitance auditory data using SQL. To accomplish this, I will query the WAI Database and build a dataset that can be used to recreate the Mean Absorbance vs. Frequency figure from Voss’s 2020 article on wideband acoustic immitance. I will use three tables from the database: Measurements - a table containing WAI measurements for each subject and session from several different studies, PI_Info - a table holding logistic details about each study, and Subjects - a table with demographic and other information about each subject across all studies. Using SQL, I will join parts of these tables to compile information from 12 different studies, and plot the mean absorption vs frequency results for each, as in Figure 1 (Voss 2020). Then, I will inspect the 2023 WAI study by Sun et al., and use a similar process to plot and determine discrepancies in mean absorbance by age.\n\nlibrary(tidyverse)\nlibrary(RMariaDB)\ncon_wai &lt;- dbConnect(\n  MariaDB(), host = \"scidb.smith.edu\",\n  user = \"waiuser\", password = \"smith_waiDB\", \n  dbname = \"wai\"\n)\n\nMeasurements &lt;- tbl(con_wai, \"Measurements\")\nPI_Info &lt;- tbl(con_wai, \"PI_Info\")\nSubjects &lt;- tbl(con_wai, \"Subjects\")\n\n\nSELECT Measurements.Identifier,\n        AVG(Absorbance) AS Mean_Absorbance,\n        Frequency,\n        CONCAT(AuthorsShortList, \" (\", Year, \") \", \" N= \", \n        COUNT(DISTINCT SubjectNumber, Ear), \" ; \", Instrument) AS Label\nFROM Measurements\nJOIN PI_Info ON Measurements.Identifier = PI_Info.Identifier\nWHERE (Measurements.Identifier = \"Abur_2014\" OR\n      Measurements.Identifier = \"Feeney_2017\" OR\n      Measurements.Identifier = \"Groon_2015\" OR\n      Measurements.Identifier = \"Lewis_2015\" OR\n      Measurements.Identifier = \"Liu_2008\" OR\n      Measurements.Identifier = \"Rosowski_2012\" OR\n      Measurements.Identifier = \"Shahnaz_2006\" OR\n      Measurements.Identifier = \"Shaver_2013\" OR\n      Measurements.Identifier = \"Sun_2016\" OR\n      Measurements.Identifier = \"Voss_1994\" OR\n      Measurements.Identifier = \"Voss_2010\" OR\n      Measurements.Identifier = \"Werner_2010\") AND\n      Measurements.Frequency &gt; 200 AND Measurements.Frequency &lt; 8000\nGROUP BY Measurements.Identifier, Frequency, Instrument;\n\n\nhead(ears)\n\n  Identifier Mean_Absorbance Frequency                              Label\n1  Abur_2014      0.07847459   210.938 Abur et al. (2014)  N= 14 ; HearID\n2  Abur_2014      0.08264199   234.375 Abur et al. (2014)  N= 14 ; HearID\n3  Abur_2014      0.09484823   257.812 Abur et al. (2014)  N= 14 ; HearID\n4  Abur_2014      0.10314722   281.250 Abur et al. (2014)  N= 14 ; HearID\n5  Abur_2014      0.11375764   304.688 Abur et al. (2014)  N= 14 ; HearID\n6  Abur_2014      0.12212053   328.125 Abur et al. (2014)  N= 14 ; HearID\n\n\nThis table displays the mean measured absorbance for ears at each frequency, separated by study, using information from the Measurements and PI_Info tables. It also contains information to go in the legend of the plot, including the instrument used, number of ears, year, and authors for each study.\nPlotting The Data\n\nlibrary(scales)\n\nears |&gt;\n  ggplot(aes(x = Frequency, y = Mean_Absorbance, color = Label)) +\n  geom_line() +\n  xlim(200, 8000) +\n  ylim(0, 1) +\n  labs(\n    title = \"Mean absorbance from each publication in WAI database\",\n    x = \"Frequency(Hz)\",\n    y = \"Mean Absorbance\",\n    color = NULL\n  ) +\n  scale_x_log10(\n    limits = c(200, 8000),\n    breaks = c(200, 400, 600, 800, 1000, 2000, 4000, 6000, 8000)\n  ) +\n  scale_y_continuous(\n    limits = c(0, 1),\n    breaks = seq(0, 1, 0.2)\n  ) +\n  theme_bw() +\n  theme(\n    plot.background = element_rect(\n      fill = \"grey90\", \n      color = \"grey90\", \n      size = 30),\n    legend.position = c(0.01, 0.99),\n    legend.justification = c(0, 1),\n    legend.background = element_rect(\n      color = \"black\",\n      size = 0.3,\n      fill = \"white\"\n    ),\n    legend.text = element_text(size = 7),\n    legend.key.height = unit(0.15, \"mm\"),\n    legend.key = element_rect(size = 0.1),\n    legend.key.size = unit(1, \"cm\"),\n    aspect.ratio = 0.8,\n    text = element_text(face = \"bold\"),\n    plot.title = element_text(hjust = 0.5),\n    plot.margin = margin(12, 12, 12, 12)\n  )\n\n\n\n\n\n\n\n\nThe above graph displays the mean percent absorbance per frequency (in hertz), from each study’s findings, separated by color. Each line appears to follow a similar trend, with low absorbances at low frequencies, increasing to a maximum absorbancy between 2000 and 4000 hz, before dropping back down to low absorbance levels at higher frequencies. Notably, in my plot the Feeney et al. study has much lower absorbances between 1000 and 3000 hz frequencies than all of the other observed studies. This contrast does not appear in Voss’ version of the plot.\nPart 2: Examining Sun’s 2023 Study for Absorption Differences by Age\n\nSELECT *\nFROM Subjects\nWHERE Identifier = \"Sun_2023\"\nLIMIT 3500, 20;\n\n\nDisplaying records 1 - 10\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIdentifier\nSubjectNumber\nSessionTotal\nAgeFirstMeasurement\nAgeCategoryFirstMeasurement\nSex\nRace\nEthnicity\nLeftEarStatusFirstMeasurement\nRightEarStatusFirstMeasurement\nSubjectNotes\n\n\n\n\nSun_2023\n124137\n1\n12\nChild\nFemale\nOther\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124139\n1\n16\nChild\nFemale\nCaucasian\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124140\n1\n17\nChild\nFemale\nCaucasian\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124141\n1\n17\nChild\nMale\nBlack\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124150\n1\n14\nChild\nFemale\nBlack\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124154\n1\n16\nChild\nMale\nBlack\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124155\n1\n9\nChild\nMale\nCaucasian\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124162\n1\n9\nChild\nFemale\nOther\nHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124166\n1\n8\nChild\nFemale\nCaucasian\nNonHispanic\nNormal\nNormal\nNA\n\n\nSun_2023\n124196\n1\n75\nAdult\nFemale\nOther\nNonHispanic\nNormal\nNormal\nNA\n\n\n\n\n\nShown above is an example of 20 rows of data from Sun’s study, taken from the Subjects table.\n\nSELECT Measurements.Identifier,\n        AVG(Absorbance) AS Mean_Absorbance,\n        Frequency,\n        CONCAT(AuthorsShortList, \" (\", Year, \") \", \" N= \", COUNT(DISTINCT Measurements.SubjectNumber, Ear), \" ; \", Instrument) AS Label,\n        FLOOR(Age / 10) AS Age_Group\n        \nFROM Measurements\nJOIN PI_Info ON Measurements.Identifier = PI_Info.Identifier \nJOIN Subjects ON Subjects.SubjectNumber = Measurements.SubjectNumber\nWHERE Measurements.Identifier = \"Sun_2023\" AND\n      Measurements.Frequency &gt; 200 AND Measurements.Frequency &lt; 8000\nGROUP BY Age_Group, Frequency, Instrument;\n\n\nhead(demo_ears)\n\n  Identifier Mean_Absorbance Frequency                             Label\n1   Sun_2023       0.1082925  226.0000 Sun et al. (2023)  N= 574 ; Titan\n2   Sun_2023       0.1375110  257.3256 Sun et al. (2023)  N= 574 ; Titan\n3   Sun_2023       0.1543347  280.6155 Sun et al. (2023)  N= 574 ; Titan\n4   Sun_2023       0.1516369  297.3018 Sun et al. (2023)  N= 574 ; Titan\n5   Sun_2023       0.1489815  324.2099 Sun et al. (2023)  N= 574 ; Titan\n6   Sun_2023       0.1644526  343.4884 Sun et al. (2023)  N= 574 ; Titan\n  Age_Group\n1         0\n2         0\n3         0\n4         0\n5         0\n6         0\n\n\nThis table shows the mean measured absorbance for ears at each frequency, grouped by the age range of the subject (age group is the subject’s age, divided by 10).\n\ndemo_ears &lt;- demo_ears |&gt; \n  mutate(Age_Label = case_when(\n    Age_Group == 0 ~ \"0-9 years\",\n    Age_Group == 1 ~ \"10-19 years\",\n    Age_Group == 2 ~ \"20-29 years\",\n    Age_Group == 3 ~ \"30-39 years\",\n    Age_Group == 4 ~ \"40-49 years\",\n    Age_Group == 5 ~ \"50-59 years\",\n    Age_Group == 6 ~ \"60-69 years\",\n    Age_Group == 7 ~ \"70-79 years\",\n    Age_Group == 8 ~ \"80-89 years\"\n  ))\n\ndemo_ears |&gt;\n  ggplot(aes(x = Frequency, y = Mean_Absorbance, color = Age_Label)) +\n  geom_line() +\n  xlim(200, 8000) +\n  ylim(0, 1) +\n  labs(\n    title = \"Mean absorbance by age group in WAI database Sun et al. 2023 study\",\n    x = \"Frequency(Hz)\",\n    y = \"Mean Absorbance\",\n    color = NULL\n  ) +\n  scale_x_log10(\n    limits = c(200, 8000),\n    breaks = c(200, 400, 600, 800, 1000, 2000, 4000, 6000, 8000)\n  ) +\n  scale_y_continuous(\n    limits = c(0, 1),\n    breaks = seq(0, 1, 0.2)\n  ) +\n  theme_bw() +\n  theme(\n    plot.background = element_rect(\n      fill = \"grey90\", \n      color = \"grey90\", \n      size = 30),\n    legend.position = c(0.01, 0.99),\n    legend.justification = c(0, 1),\n    legend.background = element_rect(\n      color = \"black\",\n      size = 0.3,\n      fill = \"white\"\n    ),\n    legend.text = element_text(size = 7),\n    legend.key.height = unit(0.15, \"mm\"),\n    legend.key = element_rect(size = 0.1),\n    legend.key.size = unit(1, \"cm\"),\n    aspect.ratio = 0.8,\n    text = element_text(face = \"bold\"),\n    plot.title = element_text(hjust = 0.5),\n    plot.margin = margin(30, 70, 30, 40)\n  )\n\n\n\n\n\n\n\n\nThis plot is similar to the first but focused in on the Sun study exclusively, with mean absorbance levels colored by age group. Accordingly, we can see the trend of absorbance increasing with frequency until about 1000 hz. Sun’s study evens out a bit more with maxes somewhat spread out between 1000 and 4000hz and then dropping back down at higher frequencies. According to this plot, the only age group that clearly breaks this trend is the oldest group, 80-89-year-old ears with generally much lower absorbances and a max right near 4000hz. Interstingly, the 70-79 year age group does not show any of this decline, and in fact holds some of the highest mean absorbances across frequencies.\nProcess/Discussion\nAfter gathering data, I began by selecting the studies I wanted to work with, and finding variables I needed to include across tables. All of the label and measurement information for the first plot was contained between the PI_Info and Measurements tables, so I joined selected variables from these and grouped by study and frequency in order to obtain a summarized mean absorbance across each frequency per study to plot. I was then able to recreate Voss’ s figure using ggplot. There were some limitations to this, as some of the numbers in the data were slightly different from what was shown in Voss’s plot. For instance, the number of ears in Werner’s 2010 study was listed as N=267 in her plot, where my plot used 962 ears.\nAfter duplicating this plot as closely as possible, I used similar data wrangling to obtain a table and plot of mean absorbance data by age from the study by Sun et al., 2023. I chose to group age by 10 years to simplify and increase readability. I modeled the plot similarly to Voss’s Figure 1, and it showed a sizable difference in shape and height of the curve for mean absorbances of 80-89 year old ears.\nSource\nVoss SE. Resource Review. Ear Hear. 2019 Nov/Dec;40(6):1481. doi: 10.1097/AUD.0000000000000790. PMID: 31651606; PMCID: PMC7093226.\ndoi.org/10.35482/egr.001.2022\n\ndbDisconnect(con_wai, shutdown = TRUE)"
  },
  {
    "objectID": "textanalysis.html",
    "href": "textanalysis.html",
    "title": "Text Analysis",
    "section": "",
    "text": "Question 1: Which president (Bill Clinton or George W. Bush) was mentioned in more NYT Headlines during their respective presidential terms (Clinton 1997-2000 / Bush 2001-2004)?\n\nNYTimes &lt;- NYTimes |&gt;\n \n  # create a column for year using date\n  mutate(Year_str = str_extract(Date, \"\\\\D-\\\\d\\\\d\")) |&gt;\n  mutate(Year = str_sub(Year_str, 3, 4))\n\n# Headlines with \"Clinton\" between 1997 and 2000  \nClinton_Headlines &lt;- NYTimes |&gt;\n  filter(Year &gt;= 97 | Year == \"00\") |&gt;\n  filter(str_detect(Title, \"Clinton\")) |&gt;\n  select(Date, Year, Title) |&gt;\n  mutate(President = \"Clinton\")\n\n# Headlines with \"Bush\" between 2001 and 2004\nBush_Headlines &lt;- NYTimes |&gt;\n  filter(Year &lt;= 04, Year != \"00\", Year != \"05\", Year != \"06\") |&gt;\n  filter(str_detect(Title, \"Bush\")) |&gt;\n  select(Date, Year, Title) |&gt;\n  mutate(President = \"Bush\")\n\n#Join these two together to plot\nBoth_Headlines &lt;- full_join(Clinton_Headlines, Bush_Headlines) |&gt;\n  group_by(President, Year) |&gt;\n  summarize(num_headlines = n())\n\n# bar chart\nggplot(Both_Headlines, aes(x = fct_rev(President), y = num_headlines, \n                           fill = fct_relevel(Year, c(\"97\", \"98\",\"99\", \"00\", \"01\", \"02\", \"03\", \"04\")))) + \n  geom_col() + \n  scale_x_discrete(labels=c('Clinton (1997-2000)', 'Bush (2001-2004)')) + \n  labs(\n    title = \"Clinton v Bush: Which President Had More Headlines During Their Term?\",\n    x = \"President\",\n    y = \"Number of Mentions in NYT Headlines During Term\",\n    fill = \"Year\"\n  ) + \n  theme_classic()\n\n\n\n\n\n\n\n\nThis plot shows the number of New York Times headlines that each president was mentioned in during their consecutive terms (Bill Clinton 1997-2000 and George W. Bush 2001-2004) by year. Based on the plot, there is clearly a large difference in both the total number of headlines for each president, where Bush had a total of 65 headline mentions between 2001 and 2004 and Clinton only had 20. There does not seem to be a consistent pattern of increase or decrease of headlines by year during a presidential term. Notably, Bush had a huge surge of headlines in 2001 which is likely due to the influx of New York Times articles around the crisis of 9/11. It would be interesting to look at whether there was also a large difference in the total number of New York Times articles in this data set between 1997-2000 and 2001-2004 that might confound these results.\nQuestion 2: Does the typical number of words per headline vary by month? Does this relationship change depending on whether the headline contains punctuation?\n\nNYTimesWM &lt;- NYTimes |&gt;\n  # extract month from date as new variable\n  mutate(Month = str_extract(Date, \"(?&lt;=-).+(?=-)\")) |&gt;\n  mutate(word_list = str_split(Title, \" \")) |&gt;\n  mutate(num_words = lengths(word_list)) |&gt;\n  # variable for whether headline contains punctuation\n  mutate(Punctuation = grepl(\"[[:punct:]]\", Title))\n\n\n# boxplot  \nggplot(NYTimesWM, aes(x = fct_relevel(Month, c('Jan', 'Feb', 'Mar',\n                                               'Apr', 'May', 'Jun',\n                                               'Jul', 'Aug', 'Sep',\n                                               'Oct', 'Nov', 'Dec')), \n                      y = num_words, color = Punctuation)) + \n  geom_boxplot() + \n  labs(\n    title = \"Length of New York Times Headlines by Month \n    With and Without Punctuation Between 1996 and 2006\",\n    x = \"Month\",\n    y = \"Number of Words Per Headline\"\n  )\n\n\n\n\n\n\n\n\nThis plot shows the distributions of the number of words per headline for each month for headlines with and without punctuation. By month, the distributions do not show a clear trend, but the ranges for February and November with punctuation appear to be the largest overall excluding outliers, while May has both the longest headline (largest outlier) and one of the shortest, at one word. However, looking at the comparison between headlines with punctuation and headlines without punctuation, the ranges for headlines with punctuation are longer for every single month, and there are also far more outliers on the high end for this category. In fact, the upper quartile for headlines with punctuation is a larger number of words for every month except August, which is even with no punctuation. These results are understandable considering that longer sentences are more likely to need punctuation in order to have proper grammar. The months with the largest difference between punctuation and no punctuation in median number of words per headline are September and November."
  }
]